<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Complete Kratky Hydroponics Guide</title>
    <link rel="icon" type="image/png" href="images/icon.png">
    <style>
        :root {
            --primary: #2f855a;
            --primary-dark: #22543d;
            --accent: #2b6cb0;
            --bg: #f7fafc;
            --card-bg: #ffffff;
            --text: #2d3748;
            --border: #e2e8f0;
            --warning: #ed8936;
            --danger: #e53e3e;
        }

        body {
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--bg);
            color: var(--text);
            line-height: 1.6;
            margin: 0;
            padding: 0;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Header */
        header {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            padding: 60px 20px;
            text-align: center;
            border-radius: 0 0 20px 20px;
            margin-bottom: 40px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        header h1 { margin: 0; font-size: 2.5rem; letter-spacing: 1px; }
        header p { font-size: 1.1rem; opacity: 0.9; margin-top: 10px; }

        /* Sections */
        section {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            border: 1px solid var(--border);
        }

        h2 { color: var(--primary-dark); border-bottom: 2px solid var(--primary); padding-bottom: 10px; margin-top: 0; }
        h3 { color: var(--accent); margin-top: 25px; }

        /* Diagrams */
        .diagram-container {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 20px;
            margin: 20px 0;
            background: #f0fff4;
            padding: 20px;
            border-radius: 10px;
            border: 1px solid #c6f6d5;
        }

        .diagram-caption {
            text-align: center;
            font-size: 0.9rem;
            color: #555;
            max-width: 300px;
        }

        /* Calculator */
        .calculator-box {
            background: #ebf8ff;
            border: 2px solid var(--accent);
            padding: 25px;
            border-radius: 12px;
        }

        .input-group {
            display: flex;
            gap: 10px;
            align-items: center;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }

        input, select {
            padding: 10px;
            border: 1px solid #cbd5e0;
            border-radius: 6px;
            font-size: 1rem;
        }

        .calc-results {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .result-card {
            background: white;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        .result-card strong { display: block; font-size: 1.4rem; color: var(--primary); }
        .result-card small { color: #718096; }

        /* Video Grid */
        .video-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
        }

        .video-card {
            background: white;
            border: 1px solid var(--border);
            border-radius: 8px;
            overflow: hidden;
            transition: transform 0.2s;
        }

        .video-card:hover { transform: translateY(-3px); box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
        
        .video-thumb {
            width: 100%;
            height: 160px;
            background: #cbd5e0;
            position: relative;
            background-size: cover;
            background-position: center;
        }
        
        .play-icon {
            position: absolute;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            width: 40px; height: 40px;
            background: rgba(0,0,0,0.6);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 20px;
        }

        .video-info { padding: 15px; }
        .video-title { font-weight: bold; margin-bottom: 5px; display: block; color: var(--text); text-decoration: none; }
        .video-meta { font-size: 0.85rem; color: #718096; }

        /* Tip Box */
        .tip-box {
            background: #fffaf0;
            border-left: 4px solid var(--warning);
            padding: 15px;
            margin: 15px 0;
        }

        /* SVG Styles */
        text { font-family: sans-serif; }

        /* Navigation Toggle Button */
        .nav-toggle {
            position: fixed;
            top: 20px;
            left: 20px;
            z-index: 1001;
            background: var(--primary);
            color: white;
            border: none;
            padding: 12px 16px;
            border-radius: 8px;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            font-size: 1rem;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s;
        }

        .nav-toggle:hover {
            background: var(--primary-dark);
            transform: scale(1.05);
        }

        .nav-toggle .hamburger {
            display: flex;
            flex-direction: column;
            gap: 3px;
        }

        .nav-toggle .hamburger span {
            display: block;
            width: 20px;
            height: 2px;
            background: white;
            transition: all 0.3s;
        }

        .nav-toggle.active .hamburger span:nth-child(1) {
            transform: rotate(45deg) translate(5px, 5px);
        }

        .nav-toggle.active .hamburger span:nth-child(2) {
            opacity: 0;
        }

        .nav-toggle.active .hamburger span:nth-child(3) {
            transform: rotate(-45deg) translate(5px, -5px);
        }

        /* Navigation Overlay */
        .nav-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            z-index: 999;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s;
        }

        .nav-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        /* Navigation Panel */
        .nav-panel {
            position: fixed;
            top: 0;
            left: -100%;
            width: 300px;
            height: 100vh;
            background: var(--card-bg);
            box-shadow: none;
            z-index: 1000;
            padding: 80px 25px 25px 25px;
            overflow-y: auto;
            transition: left 0.3s ease-in-out, box-shadow 0.3s ease-in-out;
        }

        .nav-panel.active {
            left: 0;
            box-shadow: 4px 0 20px rgba(0,0,0,0.15);
        }

        .nav-panel h3 {
            margin: 0 0 20px 0;
            color: var(--primary-dark);
            font-size: 1.3rem;
            border-bottom: 2px solid var(--primary);
            padding-bottom: 10px;
        }

        .nav-panel ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .nav-panel li {
            margin: 0;
        }

        .nav-panel a {
            color: var(--accent);
            text-decoration: none;
            display: block;
            padding: 12px 15px;
            border-radius: 6px;
            transition: all 0.2s;
            font-size: 1rem;
            border-left: 3px solid transparent;
        }

        .nav-panel a:hover {
            background: var(--bg);
            color: var(--primary);
            border-left-color: var(--primary);
        }

        .nav-panel a.active {
            background: var(--primary);
            color: white;
            border-left-color: var(--primary-dark);
        }

        /* Mobile optimisations */
        @media (max-width: 768px) {
            .nav-toggle {
                top: 15px;
                left: 15px;
                padding: 10px 14px;
            }
        }

        @media (max-width: 480px) {
            .nav-panel {
                width: 85%;
                padding: 70px 20px 20px 20px;
            }
        }

        /* Home Button */
        .home-btn {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1001;
            background: white;
            color: var(--primary);
            border: 2px solid var(--primary);
            padding: 10px 18px;
            border-radius: 8px;
            text-decoration: none;
            font-weight: bold;
            font-size: 0.9rem;
            transition: all 0.3s;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .home-btn:hover {
            background: var(--primary);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        @media (max-width: 768px) {
            .home-btn {
                top: 15px;
                right: 15px;
                padding: 8px 14px;
                font-size: 0.85rem;
            }
        }
    </style>
</head>
<body>

<!-- Home Button -->
<a href="index.html" class="home-btn">üè† Home</a>

<!-- Navigation Toggle Button -->
<button class="nav-toggle" id="navToggle" aria-label="Toggle navigation">
    <div class="hamburger">
        <span></span>
        <span></span>
        <span></span>
    </div>
    <span>Menu</span>
</button>

<!-- Navigation Overlay -->
<div class="nav-overlay" id="navOverlay"></div>

<header>
    <h1>The Complete Kratky Hydroponics Guide</h1>
    <p>Passive ‚Ä¢ Non-Circulating ‚Ä¢ Off-Grid ‚Ä¢ "Set It and Forget It"</p>
    <p style="font-size: 0.9rem; margin-top:20px;">Aggregated from the community's best growers</p>
</header>

<!-- NAVIGATION PANEL -->
<nav class="nav-panel" id="navPanel">
    <h3>Quick Navigation</h3>
    <ul>
        <li><a href="#intro">What is Kratky?</a></li>
        <li><a href="#visualization">Growth Cycle</a></li>
        <li><a href="#calculator">Nutrient Calculator</a></li>
        <li><a href="#ph-balancing">pH Balancing</a></li>
        <li><a href="#outdoor">Outdoor Setup</a></li>
        <li><a href="#videos">Reference Videos</a></li>
    </ul>
</nav>

<div class="container">

    <!-- INTRO -->
    <section id="intro">
        <h2>What is the Kratky Method?</h2>
        <p>Developed by B.A. Kratky at the University of Hawaii, this method is a passive hydroponic technique that requires <strong>no electricity, no pumps, and no moving parts</strong>. The plant is suspended above a nutrient solution. As the plant drinks, the water level drops, creating an air gap. The roots differentiate into two types:</p>
        <ul>
            <li><strong>Water Roots:</strong> Lower roots that stay submerged to absorb water and nutrients.</li>
            <li><strong>Air Roots (Oxygen Roots):</strong> Upper roots that hang in the moist air gap to absorb oxygen.</li>
        </ul>
        <div class="tip-box">
            <strong>The Golden Rule:</strong> Never refill the container all the way to the top once the plant is established. You will drown the air roots and kill the plant. Only refill up to 50-75% capacity.
        </div>
    </section>

    <!-- VISUALIZATION -->
    <section id="visualization">
        <h2>The Growth Cycle Visualisation</h2>
        <div class="diagram-container">
            <img src="images/The Growth Cycle Visualization.png" alt="The Growth Cycle Visualisation showing the three stages of Kratky hydroponics: Setup, Growth, and Harvest" style="max-width: 100%; height: auto; border-radius: 8px;">
        </div>
    </section>

    <!-- NUTRIENT CALCULATOR -->
    <section id="calculator">
        <h2>Nutrient Calculator</h2>
        <p>Select your preferred nutrient method. <strong>Mixing Order is Critical!</strong> Dissolve each part completely before adding the next to avoid nutrient lockout (precipitation).</p>
        
        <div class="calculator-box">
            <div class="input-group">
                <label><strong>Container Size:</strong></label>
                <input type="number" id="volInput" value="5" style="width: 80px;">
                <select id="unitInput">
                    <option value="gal">Gallons (US)</option>
                    <option value="liter">Liters</option>
                </select>
            </div>

            <div class="input-group">
                <label><strong>Nutrient Type:</strong></label>
                <select id="typeInput" onchange="toggleCalc()">
                    <option value="masterblend">Masterblend (Tomato Formula 4-18-38)</option>
                    <option value="flora">General Hydroponics (Flora Series)</option>
                </select>
            </div>

            <hr style="border: 0; border-top: 1px solid #cbd5e0; margin: 20px 0;">

            <!-- Masterblend Output -->
            <div id="mb-results" class="calc-results">
                <div class="result-card">
                    <small>Step 1: Masterblend</small>
                    <strong id="res-mb">0 g</strong>
                    <small>4-18-38 Base</small>
                </div>
                <div class="result-card">
                    <small>Step 2: Epsom Salt</small>
                    <strong id="res-epsom">0 g</strong>
                    <small>Magnesium Sulfate</small>
                </div>
                <div class="result-card">
                    <small>Step 3: Calcium Nitrate</small>
                    <strong id="res-cal">0 g</strong>
                    <small>15.5-0-0</small>
                </div>
            </div>

            <!-- Flora Output -->
            <div id="flora-results" class="calc-results" style="display:none;">
                <div class="result-card">
                    <small>Step 1: FloraMicro</small>
                    <strong id="res-micro">0 ml</strong>
                    <small>(Dark Red/Brown)</small>
                </div>
                <div class="result-card">
                    <small>Step 2: FloraGrow</small>
                    <strong id="res-grow">0 ml</strong>
                    <small>(Green)</small>
                </div>
                <div class="result-card">
                    <small>Step 3: FloraBloom</small>
                    <strong id="res-bloom">0 ml</strong>
                    <small>(Pink/Red)</small>
                </div>
            </div>
            
            <p style="margin-top: 15px; font-size: 0.9rem; color: #666; text-align: center;">
                *Ratios based on standard leafy green/vegetative stage recommendations. <br>
                <strong>Always verify pH is between 5.5 and 6.5 after mixing.</strong>
            </p>
        </div>
    </section>

    <!-- PH BALANCING SECTION -->
    <section id="ph-balancing">
        <h2>pH Balancing: The Invisible Killer</h2>
        <p>In the "Tomato Update" video, the grower noted a critical warning sign: <strong>leaves that felt like "wet tissue paper."</strong> This was caused by nutrient issues and incorrect pH. In a Kratky system, you don't have a pump circulating water to buffer changes, so getting the pH right <em>before</em> you walk away is vital.</p>

        <div style="display: flex; flex-wrap: wrap; gap: 20px; align-items: center;">
            <div style="flex: 1; min-width: 300px;">
                <div class="tip-box" style="border-left-color: var(--danger);">
                    <strong>The Danger Zone:</strong> If your pH is too high (above 7.0) or too low (below 5.0), the plant cannot absorb specific nutrients even if they are sitting right there in the water. This is called <em>Nutrient Lockout</em>.
                </div>
                <h3>The Balancing Protocol</h3>
                <ol>
                    <li><strong>Mix First:</strong> Add all your fertiliser components to the water first. Nutrients often lower the pH slightly.</li>
                    <li><strong>Test:</strong> Use a digital metre or a liquid drop test kit.</li>
                    <li><strong>Target:</strong> Aim for a pH between <strong>5.5 and 6.5</strong>.
                        <ul>
                            <li><em>5.8 - 6.0</em> is the "sweet spot" for most vegetables.</li>
                        </ul>
                    </li>
                    <li><strong>Adjust:</strong>
                        <ul>
                            <li><strong>Too High (7.0+):</strong> Most common with tap water. Add "pH Down" (Phosphoric acid) in very small increments (drops).</li>
                            <li><strong>Too Low (<5.0):</strong> Add "pH Up" (Potassium Hydroxide) or simply add more plain tap water.</li>
                        </ul>
                    </li>
                </ol>
            </div>

            <!-- SVG: pH Scale Visualization -->
            <div style="flex: 0 0 250px; text-align: center;">
                <svg width="220" height="320" viewBox="0 0 220 320">
                    <!-- Gradient Bar -->
                    <defs>
                        <linearGradient id="phGrad" x1="0%" y1="0%" x2="0%" y2="100%">
                            <stop offset="0%" style="stop-color:#dc2626;stop-opacity:1" /> <!-- 4.0 Acidic Red -->
                            <stop offset="20%" style="stop-color:#f97316;stop-opacity:1" /> <!-- 4.8 Orange -->
                            <stop offset="30%" style="stop-color:#eab308;stop-opacity:1" /> <!-- 5.3 Yellow -->
                            <stop offset="50%" style="stop-color:#16a34a;stop-opacity:1" /> <!-- 6.0 Green (Sweet Spot Centre) -->
                            <stop offset="62%" style="stop-color:#14b8a6;stop-opacity:1" /> <!-- 6.8 Teal -->
                            <stop offset="75%" style="stop-color:#0891b2;stop-opacity:1" /> <!-- 7.5 Cyan -->
                            <stop offset="100%" style="stop-color:#7c3aed;stop-opacity:1" /> <!-- 9.0 Purple -->
                        </linearGradient>
                    </defs>

                    <!-- pH Meter Bar -->
                    <rect x="85" y="30" width="50" height="260" fill="url(#phGrad)" rx="8" stroke="#2d3748" stroke-width="2.5"/>

                    <!-- pH Markers -->
                    <!-- 9.0 Alkaline -->
                    <line x1="65" y1="290" x2="145" y2="290" stroke="#2d3748" stroke-width="2"/>
                    <text x="155" y="295" font-size="13" font-weight="500" fill="#2d3748">9.0 Alkaline</text>

                    <!-- 7.0 Neutral -->
                    <line x1="65" y1="186" x2="145" y2="186" stroke="#2d3748" stroke-width="2"/>
                    <text x="155" y="191" font-size="13" font-weight="500" fill="#2d3748">7.0 Neutral</text>

                    <!-- 4.0 Acidic -->
                    <line x1="65" y1="30" x2="145" y2="30" stroke="#2d3748" stroke-width="2"/>
                    <text x="155" y="35" font-size="13" font-weight="500" fill="#2d3748">4.0 Acidic</text>

                    <!-- Sweet Spot Highlight (5.5 - 6.5) -->
                    <!-- pH 4.0 is at y=30, pH 9.0 is at y=290, so 5 pH units = 260px -->
                    <!-- 5.5 is 1.5 units from 4.0 = 78px from top = y=108 -->
                    <!-- 6.5 is 2.5 units from 4.0 = 130px from top = y=160 -->
                    <rect x="78" y="108" width="64" height="52" fill="none" stroke="#16a34a" stroke-width="3" stroke-dasharray="6,3" rx="4"/>

                    <!-- Sweet Spot Labels -->
                    <line x1="145" y1="134" x2="165" y2="134" stroke="#16a34a" stroke-width="2"/>
                    <text x="10" y="125" font-size="15" font-weight="bold" fill="#16a34a">5.5 - 6.5</text>
                    <text x="10" y="142" font-size="12" fill="#16a34a">(Sweet Spot)</text>
                </svg>
            </div>
        </div>
    </section>

    <!-- OUTDOOR SETUP -->
    <section id="outdoor">
        <h2>Outdoor Setup & The "Overflow Hole"</h2>
        <p>If you are growing peppers or tomatoes outdoors in Kratky buckets, rain is your enemy. If rain fills the bucket to the top, the air roots will drown.</p>
        
        <div style="display: flex; gap: 30px; align-items: center; flex-wrap: wrap-reverse;">
            <div style="flex: 1; min-width: 300px;">
                <h3>Instructions:</h3>
                <ol>
                    <li>Use a 5-gallon bucket with a lid.</li>
                    <li>Drill a 3-inch hole in the lid for your net cup.</li>
                    <li><strong>Crucial Step:</strong> Drill a small (1/4 inch) hole on the side of the bucket, about 1.5 to 2 inches below the bottom of the net cup.</li>
                    <li>This acts as an overflow drain. Even during heavy rain, an air gap is guaranteed.</li>
                    <li>Wrap the bucket in foil or paint it black (then white) to light-proof it. Light = Algae = Root Rot.</li>
                </ol>
            </div>
            <div style="flex: 0 0 300px; text-align: center;">
                <img src="images/outdoor_overflow_hole.png" alt="Outdoor Kratky setup showing bucket with overflow hole, air gap, and water level protection against rain" style="max-width: 100%; height: auto; border-radius: 8px;">
            </div>
        </div>
    </section>

    <!-- VIDEO LIBRARY -->
    <section id="videos">
        <h2>Reference Library</h2>
        <p>Direct links to the source videos used to compile this guide.</p>
        <div class="video-grid">
            
            <!-- Video 1 -->
            <a href="https://www.youtube.com/watch?v=804zwm4s83Q" target="_blank" class="video-card">
                <div class="video-thumb" style="background-image: url('https://img.youtube.com/vi/804zwm4s83Q/0.jpg')">
                    <div class="play-icon">‚ñ∂</div>
                </div>
                <div class="video-info">
                    <span class="video-title">Kratky June 2013</span>
                    <span class="video-meta">The classic introduction to lettuce rafts.</span>
                </div>
            </a>

            <!-- Video 2 -->
            <a href="https://www.youtube.com/watch?v=OvhLiREQ_H4" target="_blank" class="video-card">
                <div class="video-thumb" style="background-image: url('https://img.youtube.com/vi/OvhLiREQ_H4/0.jpg')">
                    <div class="play-icon">‚ñ∂</div>
                </div>
                <div class="video-info">
                    <span class="video-title">Growing Peppers Outside</span>
                    <span class="video-meta">Explains the overflow hole technique.</span>
                </div>
            </a>

            <!-- Video 3 -->
            <a href="https://www.youtube.com/watch?v=oDYeffYcVkY" target="_blank" class="video-card">
                <div class="video-thumb" style="background-image: url('https://img.youtube.com/vi/oDYeffYcVkY/0.jpg')">
                    <div class="play-icon">‚ñ∂</div>
                </div>
                <div class="video-info">
                    <span class="video-title">Off-Grid Hydroponics</span>
                    <span class="video-meta">MHPGardener compares systems.</span>
                </div>
            </a>

            <!-- Video 4 -->
            <a href="https://www.youtube.com/watch?v=K34skxa0ogk" target="_blank" class="video-card">
                <div class="video-thumb" style="background-image: url('https://img.youtube.com/vi/K34skxa0ogk/0.jpg')">
                    <div class="play-icon">‚ñ∂</div>
                </div>
                <div class="video-info">
                    <span class="video-title">Mixing Nutrients for Beginners</span>
                    <span class="video-meta">Step-by-step Flora Series mixing.</span>
                </div>
            </a>

            <!-- Video 5 -->
            <a href="https://www.youtube.com/watch?v=r3tz5LVVR_o" target="_blank" class="video-card">
                <div class="video-thumb" style="background-image: url('https://img.youtube.com/vi/r3tz5LVVR_o/0.jpg')">
                    <div class="play-icon">‚ñ∂</div>
                </div>
                <div class="video-info">
                    <span class="video-title">Easy Hydroponics</span>
                    <span class="video-meta">Small scale setups using recycled tubs.</span>
                </div>
            </a>

            <!-- Video 6 -->
            <a href="https://www.youtube.com/watch?v=r65cRcN4Kyc" target="_blank" class="video-card">
                <div class="video-thumb" style="background-image: url('https://img.youtube.com/vi/r65cRcN4Kyc/0.jpg')">
                    <div class="play-icon">‚ñ∂</div>
                </div>
                <div class="video-info">
                    <span class="video-title">Pepper and Tomato Update</span>
                    <span class="video-meta">Long term results of fruiting plants.</span>
                </div>
            </a>

        </div>
    </section>

</div>

<script>
    // Calculator Logic
    const volInput = document.getElementById('volInput');
    const unitInput = document.getElementById('unitInput');
    const typeInput = document.getElementById('typeInput');

    // Constants (per Gallon)
    // Masterblend: 2.4g Base, 1.2g Epsom, 2.4g CalNit
    // Flora: ~1 tsp (5ml) per gallon for general veg
    const CONSTANTS = {
        masterblend: { base: 2.4, epsom: 1.2, cal: 2.4 },
        flora: { micro: 5, grow: 5, bloom: 5 }
    };

    function toggleCalc() {
        const type = typeInput.value;
        document.getElementById('mb-results').style.display = type === 'masterblend' ? 'grid' : 'none';
        document.getElementById('flora-results').style.display = type === 'flora' ? 'grid' : 'none';
        calculate();
    }

    function calculate() {
        let vol = parseFloat(volInput.value) || 0;
        const unit = unitInput.value;
        const type = typeInput.value;

        // Convert Liters to Gallons for calculation if needed
        if (unit === 'liter') {
            vol = vol * 0.264172;
        }

        if (type === 'masterblend') {
            document.getElementById('res-mb').innerText = (vol * CONSTANTS.masterblend.base).toFixed(1) + ' g';
            document.getElementById('res-epsom').innerText = (vol * CONSTANTS.masterblend.epsom).toFixed(1) + ' g';
            document.getElementById('res-cal').innerText = (vol * CONSTANTS.masterblend.cal).toFixed(1) + ' g';
        } else {
            document.getElementById('res-micro').innerText = (vol * CONSTANTS.flora.micro).toFixed(1) + ' ml';
            document.getElementById('res-grow').innerText = (vol * CONSTANTS.flora.grow).toFixed(1) + ' ml';
            document.getElementById('res-bloom').innerText = (vol * CONSTANTS.flora.bloom).toFixed(1) + ' ml';
        }
    }

    // Event Listeners
    volInput.addEventListener('input', calculate);
    unitInput.addEventListener('change', calculate);
    
    // Init
    calculate();

    // Navigation Toggle Logic
    const navToggle = document.getElementById('navToggle');
    const navPanel = document.getElementById('navPanel');
    const navOverlay = document.getElementById('navOverlay');

    function openNav() {
        navPanel.classList.add('active');
        navOverlay.classList.add('active');
        navToggle.classList.add('active');
        document.body.style.overflow = 'hidden'; // Prevent scrolling when nav is open
    }

    function closeNav() {
        navPanel.classList.remove('active');
        navOverlay.classList.remove('active');
        navToggle.classList.remove('active');
        document.body.style.overflow = '';
    }

    navToggle.addEventListener('click', () => {
        if (navPanel.classList.contains('active')) {
            closeNav();
        } else {
            openNav();
        }
    });

    navOverlay.addEventListener('click', closeNav);

    // Smooth scrolling and active link highlighting
    document.querySelectorAll('.nav-panel a').forEach(link => {
        link.addEventListener('click', function(e) {
            e.preventDefault();
            const targetId = this.getAttribute('href').substring(1);
            const targetSection = document.getElementById(targetId);

            if (targetSection) {
                closeNav(); // Close nav when clicking a link

                // Small delay to allow nav to close smoothly
                setTimeout(() => {
                    targetSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }, 300);

                // Update active state
                document.querySelectorAll('.nav-panel a').forEach(a => a.classList.remove('active'));
                this.classList.add('active');
            }
        });
    });

    // Highlight active section on scroll
    const sections = document.querySelectorAll('section[id]');
    const navLinks = document.querySelectorAll('.nav-panel a');

    window.addEventListener('scroll', () => {
        let current = '';
        sections.forEach(section => {
            const sectionTop = section.offsetTop;
            const sectionHeight = section.clientHeight;
            if (pageYOffset >= sectionTop - 100) {
                current = section.getAttribute('id');
            }
        });

        navLinks.forEach(link => {
            link.classList.remove('active');
            if (link.getAttribute('href') === `#${current}`) {
                link.classList.add('active');
            }
        });
    });

    // Close nav on Escape key
    document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && navPanel.classList.contains('active')) {
            closeNav();
        }
    });
</script>

</body>
</html>